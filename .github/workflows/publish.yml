name: Publish to PyPI ğŸš€

# è§¦å‘æœºåˆ¶ï¼šåªæœ‰å½“ä½ åœ¨ GitHub é¡µé¢ç‚¹å‡» "Create a Release" å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶æ‰è§¦å‘
on:
  release:
    types: [published]

permissions:
  contents: read
  # é‡è¦ï¼šè¿™æ˜¯ä¸ºäº†ä½¿ç”¨ OIDC è®¤è¯ï¼Œå¿…é¡»å¼€å¯ id-token å†™æƒé™
  id-token: write 

jobs:
  build-and-publish:
    name: Build and Publish to PyPI
    runs-on: ubuntu-latest
    
    steps:
    # 1. æ‹‰å–ä»£ç 
    - name: Checkout code
      uses: actions/checkout@v4

    # 2. è®¾ç½® Python ç¯å¢ƒ
    - name: Set up Python 3.10
      uses: actions/setup-python@v5
      with:
        python-version: "3.10"

    # 3. å®‰è£…æ„å»ºå·¥å…·
    - name: Install build dependencies
      run: |
        python -m pip install --upgrade pip
        pip install build

    # 4. æ‰“åŒ…ä»£ç  (ç”Ÿæˆ .whl å’Œ .tar.gz)
    - name: Build package
      run: python -m build

    # 5. å‘å¸ƒåˆ° PyPI (ä½¿ç”¨å®˜æ–¹ Action)
    - name: Publish to PyPI
      uses: pypa/gh-action-pypi-publish@release/v1